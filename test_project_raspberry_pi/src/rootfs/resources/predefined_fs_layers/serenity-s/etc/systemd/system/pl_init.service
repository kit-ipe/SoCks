[Unit]
Description=PL Initialization
After=multi-user.target systemd-logind.service

[Service]
# Load device tree overlay
ExecStart=/usr/bin/sh -c '/usr/bin/mkdir /sys/kernel/config/device-tree/overlays/full'
ExecStart=/usr/bin/sh -c '/usr/bin/cat /etc/dt-overlays/serenity_s1_k26_pl.dtbo > /sys/kernel/config/device-tree/overlays/full/dtbo'
# Log messages in case of failure
ExecStopPost=/usr/bin/sh -c 'if [ "$$SERVICE_RESULT" != "success" ]; then /usr/bin/echo "PL initialization failed! (Run \'systemctl status pl_init\' for details)" > /dev/kmsg; fi'
Type=oneshot

[Install]
WantedBy=multi-user.target

